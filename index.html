<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>C&O Finance Co</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0a1f3d">
<link rel="apple-touch-icon" href="icon-192.png">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0a1f3d;
  color:#e5e7eb;
}

header{
  background:#020617;
  padding:25px 15px;
  text-align:center;
}

header h1{
  margin:0;
  color:#ffffff;
}

header p{
  color:#93c5fd;
}

section{
  padding:40px 20px;
  max-width:1000px;
  margin:auto;
}

.hero{
  background:#020617;
  border-radius:14px;
  padding:20px;
  margin-bottom:35px;
}

.hero img{
  width:100%;
  border-radius:12px;
  margin-bottom:15px;
}

.posts{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:20px;
}

.post{
  background:#020617;
  padding:15px;
  border-radius:12px;
}

.post img{
  width:100%;
  border-radius:10px;
  margin-bottom:10px;
}

.post h3{
  margin:8px 0;
  color:#ffffff;
}

.post p{
  font-size:14px;
  color:#cbd5f5;
}

.post a{
  display:inline-block;
  margin-top:10px;
  padding:10px 16px;
  background:#38bdf8;
  color:#020617;
  text-decoration:none;
  border-radius:8px;
  font-weight:bold;
  font-size:14px;
}

footer{
  background:#020617;
  text-align:center;
  padding:20px;
  font-size:14px;
  color:#9ca3af;
}
</style>
</head>

<body>

<header>
  <h1>C&O Finance Co</h1>
  <p>Digital Finance & Payment Solutions</p>
</header>

<section>

  <!-- HERO -->
  <div class="hero" id="hero">
    <h2>Latest Update</h2>
    <p>Loading...</p>
  </div>

  <!-- POSTS -->
  <h2>Updates</h2>
  <div class="posts" id="posts"></div>

</section>

<footer>
  © 2026 C&O Finance Co. All rights reserved.
</footer>

<script>
// ✅ CONNECTED GOOGLE SHEET
const sheetURL =
"https://spreadsheets.google.com/feeds/list/1VVdLsUFzXXVXVZpcWxDTd7JEL1i4oozji4MtRp4Jp_4/od6/public/values?alt=json";

fetch(sheetURL)
.then(res => res.json())
.then(data => {
  const rows = data.feed.entry;

  // HERO (LATEST POST)
  const latest = rows[0];
  document.getElementById("hero").innerHTML = `
    <img src="${latest.gsx$imageurl.$t}">
    <h2>${latest.gsx$title.$t}</h2>
    <p>${latest.gsx$content.$t}</p>
    <a href="${latest.gsx$buttonurl.$t}" target="_blank">Read more</a>
    <p style="font-size:13px;color:#9ca3af;margin-top:10px;">
      ${latest.gsx$date.$t}
    </p>
  `;

  // OTHER POSTS
  let postsHTML = "";
  rows.slice(1).forEach(post => {
    postsHTML += `
      <div class="post">
        <img src="${post.gsx$imageurl.$t}">
        <h3>${post.gsx$title.$t}</h3>
        <p>${post.gsx$content.$t}</p>
        <a href="${post.gsx$buttonurl.$t}" target="_blank">Read more</a>
        <p style="font-size:12px;color:#9ca3af;margin-top:8px;">
          ${post.gsx$date.$t}
        </p>
      </div>
    `;
  });

  document.getElementById("posts").innerHTML = postsHTML;
})
.catch(err => {
  document.getElementById("hero").innerHTML =
    "<p>Failed to load updates.</p>";
  console.error(err);
});
</script>

<!-- SERVICE WORKER -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/service-worker.js');
  });
}
</script>

</body>
</html>
